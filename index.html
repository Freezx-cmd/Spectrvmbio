<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spectrvm | Spotify Bio</title>
    <style>
        * { box-sizing: border-box; }
        
        body, html {
            margin: 0; padding: 0; height: 100%;
            background-color: #030303; color: #ffffff;
            font-family: 'Segoe UI', Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden; cursor: default;
        }

        /* --- AMBILIGHT ФОН --- */
        #ambilight-canvas {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 1; filter: blur(100px) brightness(0.4) saturate(1.4);
            opacity: 0; transition: opacity 2s ease; pointer-events: none; object-fit: cover;
        }

        .ambilight-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 20%, rgba(3, 3, 3, 0.8) 80%);
            z-index: 2; pointer-events: none;
        }

        /* --- ЭКРАН ВХОДА --- */
        #enter-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; justify-content: center;
            align-items: center; z-index: 999; cursor: pointer;
            transition: opacity 0.8s ease;
        }

        /* --- КОНТЕНТ (МАСШТАБ 85%) --- */
        .content-wrapper {
            position: relative; z-index: 10;
            display: flex; flex-direction: column; align-items: center;
            width: 100%; justify-content: center;
            opacity: 0; 
            transform: translateY(20px) scale(0.85); 
            transition: opacity 1s ease, transform 1s ease;
        }

        .avatar {
            width: 120px; height: 120px; border-radius: 50%;
            object-fit: cover; margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
        }

        h1 { 
            font-size: 36px; letter-spacing: 8px; margin: 0; 
            text-transform: uppercase; color: #fff;
            text-shadow: 0 0 15px rgba(255,255,255,0.2);
            text-align: center;
        }

        .status { font-size: 14px; color: #ccc; letter-spacing: 3px; margin: 10px 0 20px 0; text-transform: uppercase; }

        /* --- SPOTIFY WIDGET --- */
        .spotify-wrapper {
            display: flex; flex-direction: column; align-items: flex-start;
            margin-bottom: 35px; width: 380px;
            opacity: 0; transform: scale(0.9);
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .spotify-wrapper.active { opacity: 1; transform: scale(1); }

        .now-playing-text {
            font-size: 9px; text-transform: uppercase; letter-spacing: 2px;
            color: rgba(255, 255, 255, 0.4); margin-left: 5px; margin-bottom: 8px;
        }

        #spotify-container {
            display: flex; align-items: center; width: 100%;
            background: rgba(255, 255, 255, 0.07); backdrop-filter: blur(15px);
            padding: 15px 25px; border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .track-art {
            width: 65px; height: 65px; border-radius: 10px;
            margin-right: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            object-fit: cover;
        }

        .track-info { display: flex; flex-direction: column; overflow: hidden; text-align: left; }
        .track-name { font-size: 16px; font-weight: 700; color: #fff; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .track-artist { font-size: 13px; color: #1DB954; letter-spacing: 0.5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* --- СОЦСЕТИ --- */
        .social-row { display: flex; gap: 40px; margin-bottom: 40px; }
        .icon-link { color: #aaa; transition: 0.3s; }
        .icon-link svg { width: 30px; height: 30px; fill: currentColor; }
        .icon-link:hover { color: #fff; transform: scale(1.2); }

        /* --- МЕДИА БЛОК --- */
        .main-media-block { 
            width: 100%; max-width: 800px; position: relative; border-radius: 12px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 1); 
        }
        .video-wrapper {
            position: relative; width: 100%; border-radius: 12px;
            overflow: hidden; background: #000; border: 1px solid rgba(255, 255, 255, 0.1);
        }
        video { width: 100%; display: block; }
        .volume-container {
            width: 100%; height: 0; overflow: hidden; transition: height 0.4s ease, margin-top 0.4s;
            display: flex; align-items: center; justify-content: center;
        }
        .main-media-block:hover .volume-container { height: 45px; margin-top: 5px; }

        input[type=range] { -webkit-appearance: none; width: 80%; height: 2px; background: rgba(255, 255, 255, 0.2); outline: none; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; border-radius: 50%; background: #fff; cursor: pointer; }

        #custom-tooltip {
            position: fixed; pointer-events: none; background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1); color: #fff;
            padding: 6px 12px; border-radius: 4px; font-size: 10px;
            text-transform: uppercase; letter-spacing: 1px; opacity: 0;
            transition: opacity 0.2s; z-index: 1000; backdrop-filter: blur(5px);
        }
        
        .visible-content { opacity: 1 !important; transform: translateY(0) scale(0.85) !important; }

        @keyframes breathe { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.7; } }
    </style>
</head>
<body>

    <div id="custom-tooltip">Link</div>
    <canvas id="ambilight-canvas"></canvas>
    <div class="ambilight-overlay"></div>

    <div id="enter-screen" onclick="startBio()">
        <p style="color: #444; letter-spacing: 0.4em; text-transform: uppercase; animation: breathe 3s infinite ease-in-out;">[ click to enter ]</p>
    </div>

    <div class="content-wrapper" id="content">
        <img src="11991374.jpg" alt="Avatar" class="avatar">
        <h1>Spectrvm</h1>
        <div class="status">epicenter of happiness</div>

        <div id="spotify-wrapper" class="spotify-wrapper">
            <div class="now-playing-text">Now Playing</div>
            <div id="spotify-container">
                <img id="spotify-art" src="" class="track-art" alt="">
                <div class="track-info">
                    <div id="spotify-name" class="track-name">Loading...</div>
                    <div id="spotify-artist" class="track-artist">Spotify Status</div>
                </div>
            </div>
        </div>

        <div class="social-row">
            <a href="https://osu.ppy.sh/users/36397864" target="_blank" class="icon-link" data-tip="osu! Profile">
                <svg viewBox="0 0 512 512"><path d="M256 32C132.3 32 32 132.3 32 256s100.3 224 224 224 224-100.3 224-224S379.7 32 256 32zm0 400c-97 0-176-79-176-176S159 80 256 80s176 79 176 176-79 176-176 176zm96-176c0 53-43 96-96 96s-96-43-96-96 43-96 96-96 96 43 96 96z"/></svg>
            </a>
            <a href="https://t.me/spectrvmm" target="_blank" class="icon-link" data-tip="Telegram">
                <svg viewBox="0 0 24 24"><path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.18 1.897-.962 6.502-1.359 8.627-.168.9-.5 1.2-.822 1.23-.696.064-1.225-.46-1.901-.903-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635.099-.002.321.023.465.141.119.098.152.228.166.319.017.096.03.288.015.527z"/></svg>
            </a>
            <a href="https://steamcommunity.com/id/spectrvm/" target="_blank" class="icon-link" data-tip="Steam Profile">
                <svg viewBox="0 0 24 24"><path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm6.5 7c1.381 0 2.5 1.119 2.5 2.5S19.881 12 18.5 12 16 10.881 16 9.5 17.119 7 18.5 7zm-10.863 7.525c-.643.169-1.313.22-1.99.147l3.345-4.832a3 3 0 0 1 1.007.075l-2.362 4.61zm6.382-.316c-.017-.11-.03-.222-.039-.334 0-1.381 1.119-2.5 2.5-2.5.223 0 .438.031.645.085L12.02 14.209zM5.5 13c1.381 0 2.5 1.119 2.5 2.5S6.881 18 5.5 18 3 16.881 3 15.5 4.119 13 5.5 13z"/></svg>
            </a>
        </div>

        <div class="main-media-block">
            <div class="video-wrapper">
                <video id="video-edit" loop playsinline>
                    <source src="tikgobot_7485267304108870920.mp4" type="video/mp4">
                </video>
            </div>
            <div class="volume-container">
                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.5">
            </div>
        </div>
    </div>

    <script>
        const DISCORD_ID = '768823085481984050';

        const video = document.getElementById('video-edit');
        const ambCanvas = document.getElementById('ambilight-canvas');
        const ambCtx = ambCanvas.getContext('2d', { alpha: false });
        const slider = document.getElementById('volume-slider');
        const content = document.getElementById('content');
        const enterScreen = document.getElementById('enter-screen');
        const tooltip = document.getElementById('custom-tooltip');

        // Spotify Logic
        async function updateSpotify() {
            try {
                const response = await fetch(`https://api.lanyard.rest/v1/users/${DISCORD_ID}`);
                const result = await response.json();
                
                const wrapper = document.getElementById('spotify-wrapper');
                
                if (result.success && result.data.listening_to_spotify && result.data.spotify) {
                    const s = result.data.spotify;
                    
                    // Безопасная установка данных
                    document.getElementById('spotify-art').src = s.album_art_url || '';
                    document.getElementById('spotify-name').innerText = s.track || 'Unknown Track';
                    document.getElementById('spotify-artist').innerText = s.artist || 'Unknown Artist';
                    
                    wrapper.classList.add('active');
                } else {
                    wrapper.classList.remove('active');
                }
            } catch (e) { 
                console.error("Lanyard error:", e); 
            }
        }

        setInterval(updateSpotify, 3000);

        function drawAmbilight() {
            if (!video.paused && !video.ended) {
                ambCtx.drawImage(video, 0, 0, ambCanvas.width, ambCanvas.height);
            }
            requestAnimationFrame(drawAmbilight);
        }

        function startBio() {
            enterScreen.style.opacity = '0';
            updateSpotify();
            setTimeout(() => {
                enterScreen.style.display = 'none';
                content.classList.add('visible-content');
                ambCanvas.width = 64; ambCanvas.height = 64;
                video.muted = false; video.volume = 0.5;
                video.play().then(() => {
                    ambCanvas.style.opacity = "1";
                    drawAmbilight();
                });
            }, 800);
        }

        slider.addEventListener('input', (e) => { video.volume = e.target.value; });

        document.querySelectorAll('.icon-link').forEach(link => {
            link.addEventListener('mouseenter', () => {
                tooltip.innerText = link.getAttribute('data-tip');
                tooltip.style.opacity = '1';
            });
            link.addEventListener('mousemove', (e) => {
                tooltip.style.left = (e.clientX + 15) + 'px';
                tooltip.style.top = (e.clientY + 15) + 'px';
            });
            link.addEventListener('mouseleave', () => tooltip.style.opacity = '0');
        });
    </script>
</body>
</html>
